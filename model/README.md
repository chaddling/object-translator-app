# Serving eager-mode pretrained Pytorch model

This directory contains a Dockerfile for spinning up a `torchserve` container to serve some pretrained Pytorch models. The entrypoint:

```docker
CMD ["torchserve", "--start", "--disable-token-auth", "--ncs", "--model-store model_store", "--models fasterrcnn.mar"]
```
requires the building of a `.mar` model archive file. This requires a few options being set:
- `--serialized-file`: For eager mode models this is the serialized `state_dict` generated by the model checkpoint. Downloaded via the script `download.py`.
- `--model-file`: Necessary for eager-mode models, this is a `.py` file containing the definition of a single class (subclassed from `torch.nn.Module`) that contains the model's "forward" code.
- `--extra-files`: For the object classification part of the models, the `index_to_name.json` included here is mapping of the classes from int -> string. Taken directly from [here](https://github.com/pytorch/serve/blob/master/examples/object_detector/fast-rcnn/index_to_name.json).
